# SonicWall Configuration Export - SECURE BASELINE
# This configuration represents security best practices
# Should have minimal or no risks detected

# System Settings
firmware version 7.0.1-5050
hostname "Secure-Corporate-FW"
timezone "America/New_York"
system-name "SECURE-FW-01"

# NTP Configuration (REQUIRED - prevents NO_NTP risk)
ntp-server 0.pool.ntp.org
ntp-server 1.pool.ntp.org
ntp server time.nist.gov

# DNS Configuration
dns-server 8.8.8.8
dns-server 8.8.4.4

# Interface Configuration
interface X0 zone WAN ip 203.0.113.1 netmask 255.255.255.0
interface X1 zone LAN ip 192.168.1.1 netmask 255.255.255.0
interface X2 zone DMZ ip 10.0.0.1 netmask 255.255.255.0
interface X3 zone GUEST ip 172.16.0.1 netmask 255.255.255.0 dhcp server enable

# Security Features - ALL ENABLED
ips enable
gateway-av enable
dpi-ssl enable
app-control enable
content-filter enable
botnet enable
geo-ip enable
anti-spyware enable
atp enable

# Admin Settings - SECURE
admin username "security-admin"
admin username "john.doe"
mfa enable
https admin port 8443
ssh enable
# WAN management DISABLED (secure)

# Address Objects
address-object name "WebServer" ip 192.168.1.100 zone LAN
address-object name "MailServer" ip 192.168.1.101 zone LAN
address-object name "DMZ-Network" network 10.0.0.0/24 zone DMZ
address-object name "Internal-Network" network 192.168.0.0/16 zone LAN

# Service Objects
service-object name "HTTP" protocol tcp port 80
service-object name "HTTPS" protocol tcp port 443
service-object name "SSH" protocol tcp port 22
service-object name "SMTP" protocol tcp port 25

# Firewall Access Rules - ALL WITH DESCRIPTIONS
access-rule name "Allow-Outbound-Web" from LAN to WAN source any destination any service HTTP action allow comment "Allow web browsing for internal users"
access-rule name "Allow-Outbound-HTTPS" from LAN to WAN source any destination any service HTTPS action allow comment "Allow secure web browsing"
access-rule name "Allow-DMZ-Web" from WAN to DMZ source any destination WebServer service HTTP action allow comment "Public web server access"
access-rule name "Deny-Guest-to-LAN" from GUEST to LAN source any destination any service any action deny comment "Isolate guest network from internal resources"
access-rule name "Allow-LAN-to-DMZ" from LAN to DMZ source Internal-Network destination DMZ-Network service any action allow comment "Internal access to DMZ services"
access-rule name "Allow-DNS" from LAN to WAN source any destination any service DNS action allow comment "Allow DNS queries"

# NAT Policies
nat-policy original-source 192.168.1.0/24 translated-source 203.0.113.1 interface X0
nat-policy original-destination 203.0.113.10 translated-destination 192.168.1.100 interface X1

# VPN Configuration - STRONG ENCRYPTION
vpn policy "Site-to-Site-HQ" encryption aes256 auth certificate
vpn policy "Remote-Access-VPN" encryption aes256 auth certificate
vpn tunnel "Branch-Office" encryption aes256 authentication certificate

# High Availability Configuration
ha enable
ha role primary
ha peer 203.0.113.2

# Logging Configuration
logging enable
syslog server 192.168.1.50 port 514
log-level info

# End of Configuration
